<h1 align="center">Aсинхронный сервис управления задачами (в разработке)</h1>

---

### О проекте (легким зяыком)
Задача написать приложение (из 4-х сервисов), которое принимает задачи имеющие
статус и приоритеты.<br>
1-й сервис принимает задачу и отправляет в 2-й сервис (броекр сообщений)<br>
3-й сервис получает задачу с брокера сообщений и выполняет её (работа логики имитирована)<br>
4-й БД, куда записываются задачи с момента получения и до момента выполнения задачи<br>

### ТЗ к сервису:
Основные возможности:
	-	Создание задач через REST API
	-	Асинхронная обработка задач в фоновом режиме
	-	Возможность параллельной обработки нескольких задач
	-	Система приоритетов для задач
Статусная модель задач:
	-	NEW - новая задача
	-	PENDING - ожидает обработки
	-	IN_PROGRESS - в процессе выполнения
	-	COMPLETED - завершено успешно
	-	FAILED - завершено с ошибкой
	-	CANCELLED – отменено
Требования к задачам:
	-	Каждая задача должна иметь уникальный идентификатор
	-	Задачи должны содержать:
	    -	Название
	    -	Описание
        -	Приоритет (LOW, MEDIUM, HIGH)
        -	Cтатус
        -	Время создания
        -	Время начала выполнения
        -	Время завершения
        -	Результат выполнения
        -	Информация об ошибках (если есть)
Эндпоинты:<br>
	-	POST /api/v1/tasks - создание задачи
	-	GET /api/v1/tasks - получение списка задач с фильтрацией и пагинацией
	-	GET /api/v1/tasks/{task_id} - получение информации о задаче
	-	DELETE /api/v1/tasks/{task_id} - отмена задачи
	-	GET /api/v1/tasks/{task_id}/status - получение статуса задачи

---

### Реализация проекта
Я разделил задачу на два основных сервиса:<br>
1. API Service (FastAPI): Обрабатывает входящие HTTP-запросы (создание, получение, отмена задач). Он записывает начальное состояние задачи в базу данных и отправляет сообщение в RabbitMQ для асинхронной обработки.
2. Worker Service (Python Consumer): Постоянно слушает RabbitMQ, забирает сообщения о задачах, обрабатывает их (имитируем работу) и обновляет статус и результат задачи в базе данных.


#### Тех стек
Python, FastAPI, Uvicorn, PostgreSQL, SQLAlchemy, Alembic, RabbitMQ, Aio_pika, Pytest, Docker и Docker Compose


#### Структура проекта
```
├── app
│   ├── api
│   │   └── v1
│   │       └── tasks.py             # API-эндпоинты для задач
│   ├── core
│   │   └── config.py                # Конфигурация приложения
│   ├── db
│   │   ├── database.py              # Инициализация БД
│   │   └── base.py                  # Базовый класс для моделей SQLAlchemy
│   ├── models
│   │   └── task.py                  # Модель задачи SQLAlchemy
│   ├── queue
│   │   └── producer.py              # Отправка сообщений в RabbitMQ
│   ├── schemas
│   │   └── task.py                  # Pydantic схемы 
│   ├── worker
│   │   ├── consumer.py              # Приемка сообщений из RabbitMQ
│   │   └── processor.py             # Логика обработки задачи
│   └── main.py                      # Главный файл
├── migrations                       # Каталог Alembic для миграций
│   └── versions
├── tests
│   ├── unit                         # Юнит-тесты
│   └── integration                  # Интеграционные тесты
├── .env.example                     # Пример файла переменных окружения
├── docker-compose.yml               # Описание сервисов Docker Compose
├── Dockerfile.api                   # Dockerfile для API сервиса
├── Dockerfile.worker                # Dockerfile для Worker сервиса
├── requirements.txt                 # Зависимости Python
├── alembic.ini                      # Конфигурация Alembic
├── .gitignore                       # Игнорирование для git
├── .dockerignore                    # Игнорирование для Docker
└── README.md                        # Документация проекта
```

---

## Развертывание 

1. Клонирование приложения
```git clone https://github.com/INVESTOR-IT/Task_management```

2. Создание и инициализация .env (замените параметры на свои __обязательно__)
```cp .env.example .env```

3. Развертывание 

___

<h3 align="center">Документация в разработке</h3>